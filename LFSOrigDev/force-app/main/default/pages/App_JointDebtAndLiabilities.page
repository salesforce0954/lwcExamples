<!--
/**
 * @Description: Debt And Liabilities Page for GE Joint Loan Application
 * @Author: Fel Saliba
 * @Date Created: 01.OCT.2013
 * @History:
   =====================================================================
       10-01-13: Created - Fel
       12-02-13: Applied single set of fields - Mike
       03-25-14: Added debts exemption - Mike
       06-12-14: Added jQuery validation plugin - Davey
       02-29-16: TQLQW - 104 Rebranding - MDAVID
Sprint 4 - Time out moved to 5 mins pop up and note help text
   =====================================================================
 */ 
-->
<apex:page standardController="Application__c" extensions="APP_JointDebtAndLiabilitiesExt" sidebar="false" 
showHeader="false" id="GETemplate" standardStylesheets="false" applyHtmlTag="true" applyBodyTag="true" 
docType="html-5.0" cache="false" action="{!commonAuthorizationRequired}">
    
    <!-- Added by mlasala JUN-12-14 - JQUERY Validate Plugin 
         Notes: This must be placed here after the page definition to avoid with existing scripts. -->
    <apex:includeScript value="{!URLFOR($Resource.jQueryValidatePlugin, 'jquery-2.1.1.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.jQueryValidatePlugin, 'jquery.validate.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.jQueryValidatePlugin, 'jquery.validate.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.jQueryValidatePlugin, 'additional-methods.js')}"/>
    <apex:includeScript value="{!$Resource.jqueryValidateScript}"/>
    <apex:stylesheet value="{!URLFOR($Resource.ge_web_template, '/ge_web_template/bower_components/bootstrap/dist/css/bootstrap.min.css')}"/>
    <apex:includeScript value="{!URLFOR($Resource.ge_web_template, '/ge_web_template/bower_components/bootstrap/dist/js/bootstrap.min.js')}"/> 
    <style>
    .optionyn1 {
    float: left !important;
    width: 160px !important;
}
.popover{
    background-color: #ededed  !important;
}

.popover-title {
  background-color: #bcc3ca  !important;
  color: black  !important;
  font-size: 14.994px  !important;
  font-weight: 700  !important;
  padding: 10px 20px 11px  !important;
}

.privacyloancontent a[data-toggle="popover"]{
    color: #006ac6 !important;
    text-decoration: underline !important;
}

.privacyloancontent .popover a{
    color: #006ac6 !important;
    text-decoration: underline !important;
}
     #debtErr{
        background-color: #CC0033 !important;
    color: #ffffff !important;
    font-size: 14px !important;
    line-height: 22px;
    padding: 5px 10px !important;
    -webkit-border-radius: 0 !important;
    -moz-border-radius: 0 !important;
    border-radius: 0 !important;
    text-align: left !important;
    width: 100%;
    }
     #debtErr{
        background-color: #CC0033 !important;
    color: #ffffff !important;
    font-size: 14px !important;
    line-height: 22px;
    padding: 5px 10px !important;
    -webkit-border-radius: 0 !important;
    -moz-border-radius: 0 !important;
    border-radius: 0 !important;
    text-align: left !important;
    width: 100%;
    }
    </style>

    <apex:outputPanel rendered="{!$Site.Name=='Gem'}">
        <style>
            @media screen and (min-width: 0px) and (max-width: 425px) and (orientation: portrait) {
                .gem-mobile {
                    width: 100% !important;
                }
            }

            @media screen and (min-width: 0px) and (max-width: 320px) and (orientation: portrait) {
                .gem-mobile-button {
                    margin-left: 0px !important;
                }
                .privacyloancontent{
                  width:90% !important;
                }
            }  
            
            @media screen and (min-width: 426px) and (max-width: 536px) {
                .gem-mobile-button {
                    margin-left: 5px !important;
                }
                .privacyloancontent{
                  width:80% !important;
                }
            }  

             @media screen and (min-width: 360px) {
                .gem-mobile-button {
                    margin-left: 2px !important;
                }
                
                .privacyloancontent{
                   width:80% !important;
                 }
              }
              
             @media screen and (min-width: 375px) {
                .gem-mobile-button {
                    margin-left: 3px !important;
                }
                .privacyloancontent{
                   width:77% !important;
                 }
            } 
            
            @media screen and (min-width: 411px) and (max-width: 823px) {
                .gem-mobile-button {
                    margin-left: 0px !important;
                }
                .privacyloancontent{
                   width:69% !important;
                 }
            } 
            
            @media screen and (min-width: 414px) and (max-width: 736px) {
                .gem-mobile-button {
                    margin-left: 20px;
                }
                .privacyloancontent{
                   width:79% !important;
                 }
            }                 
          
            @media screen and (min-width: 581px) and (max-width: 767px) {
              .privacyloancontent {
                width: 124% !important;
              }            
            }

            @media screen and (min-width: 768px) and (max-width: 1024px) {
              .gem-mobile-button {
                 margin-left: 20px !important;
              }
            
             .privacyloancontent {
                width: 100% !important;
              }            
            }

            @media screen and (min-width: 794px) and (max-width: 1023px) {
              .privacyloancontent {
                width: 100% !important;
              }            
            }            
            
            @media screen and (min-width: 1024px) {
                .gem-mobile-button {
                    margin-left: 20px !important;
                }
                .privacyloancontent{
                   width:100% !important;
                 }
            }   
            
        </style>
    </apex:outputPanel>
    
        <apex:outputPanel rendered="{!$Site.Name=='Kiwibank'}">
        <style>
            @media screen and (min-width: 581px) and (max-width: 767px) {
              .privacyloancontent {
                width: 114% !important;
              }            
            }

            @media screen and (min-width: 794px) and (max-width: 1023px) {
              .privacyloancontent {
                width: 95% !important;
              }
              
              .gem-mobile-button {
                 margin-left: 20px !important;
              }
            }            

            @media screen and (min-width: 360px) and (max-width: 640px) {
                .gem-mobile-button {
                    margin-left: 5px !important;
                    padding: 3px 50px !important;
                }
                .privacyloancontent{
                  width:83% !important;
                }
            }
                                    
            @media screen and (min-width: 768px) and (max-width: 1024px) {
              .gem-mobile-button {
                 margin-left: 20px !important;
              }
            
             .privacyloancontent {
                width: 100% !important;
              }            
            }

            @media screen and (min-width: 1024px) {
                .gem-mobile-button {
                    margin-left: 20px !important;
                }
                .privacyloancontent{
                   width:100% !important;
                 }
            }   

            @media screen and (min-width: 0px) and (max-width: 425px) and (orientation: portrait) {
                .gem-mobile {
                    width: 119% !important;
                }
                .privacyloancontent{
                   width:107% !important;
                 }
            }

            @media screen and (min-width: 0px) and (max-width: 320px) and (orientation: portrait) {
                .gem-mobile-button {
                    margin-left: 0px !important;
                }
                .privacyloancontent{
                  width:96% !important;
                }
            }  
                        
             @media screen and (min-width: 375px) {
                .gem-mobile-button {
                    margin-left: 3px !important;
                }
                .privacyloancontent{
                   width:81% !important;
                 }
            }
                        
            @media screen and (min-width: 411px) and (max-width: 823px) {
                .gem-mobile-button {
                    margin-left: 0px !important;
                }
                .privacyloancontent{
                   width:73% !important;
                 }
            }
                        
            @media screen and (min-width: 414px) and (max-width: 736px) {
                .gem-mobile-button {
                    margin-left: 0px;
                }
                .privacyloancontent{
                   width:79% !important;
                 }
            }                 
                        
            @media screen and (min-width: 426px) and (max-width: 536px) and (orientation: portrait) {
               .gem-mobile {
                    width: 91% !important;
                }
                .privacyloancontent{
                   width:80% !important;
                }
                .gem-mobile-button {
                   margin-left: 13px !important;                
                }
            }
                            
        </style>
    </apex:outputPanel>

    <script>
        var j$ = jQuery.noConflict();
        function trimField(element){
            element.value = element.value.replace(/,/g,"");
        }
        
        function calculateTotalLoanAmount(elem){
            if(isNaN(elem.value)){
                elem.value = '';
            }
            UpdateAmount();
        }
        
       function hideDebtError(){
     var siteName = "{!$Site.Name}";    
      var debtExempt;
      debtExempt = document.getElementById('Applicant__c___Debts_Exempt__c').checked;
             if(siteName == 'Gem' || siteName == 'Kiwibank'){
           
           
             
             if(debtExempt == false){

                var confirmLumSumpFlag = document.getElementById('GETemplate:GETemplate:mainForm:debtPageBlock:lumpSumBlock:confirmLumSumpFlag');
                      
                if(confirmLumSumpFlag.value == ''){
                      document.getElementById('debtErr').style.display = 'block';
                      document.getElementById('debtErr').innerHTML = 'Please select an option.'; 
                      document.getElementById('debtErr').scrollIntoView({behavior: "smooth", block: "end", inline: "nearest"});
                      return false;         
                    }else{           
                     document.getElementById('debtErr').style.display = 'none';
                     return true;
                    }  
                    
                    
                 } else if(debtExempt  == true){
             return true;
           }
      } else if(siteName == 'Latitude'){
                     return true;
                   }
              }
      
        var debtLumpSumYes1 =  "GETemplate:GETemplate:mainForm:debtPageBlock:lumpSumBlock:lumpSumYes1";
        var debtLumpSumNo1  =  "GETemplate:GETemplate:mainForm:debtPageBlock:lumpSumBlock:lumpSumNo1";
       var lumSumConfirm;
       
      
        
                function applicantConfirmation(elem){
                lumSumConfirm = document.getElementById("GETemplate:GETemplate:mainForm:lumpSumValue");
                
                
                
                  if(elem.id == debtLumpSumYes1){
                        lumSumConfirm.value = elem.innerHTML.trim();
                        document.getElementById("GETemplate:GETemplate:mainForm:debtPageBlock:lumpSumBlock:confirmLumSumpFlag").value=lumSumConfirm.value;
                    }
                if(elem.id == debtLumpSumNo1){
                       lumSumConfirm.value = elem.innerHTML.trim(); 
                       document.getElementById("GETemplate:GETemplate:mainForm:debtPageBlock:lumpSumBlock:confirmLumSumpFlag").value=lumSumConfirm.value;
                   }
                
                   
                 checkRequiredfields();
                }
                
                var siteName = "{!$Site.Name}";
                var selectedStyle;
                var unSelectedStyle;
                
                if (siteName == 'Gem'){
                   selectedStyle = "color: #fff; background:#4465ad; border: 1px solid #4465ad !important;padding:3px 55px;margin-left:35px;";
                   unSelectedStyle = "color: #4465ad; background:#fff; border: 1px solid #4465ad !important;padding:3px 55px;margin-left:35px;";
                 } 
                 
                 if(siteName == 'Kiwibank'){
                   selectedStyle = "color: #fff; background:#88C83D; border: 1px solid #88C83D !important;padding:3px 55px;margin-left:35px;";
                   unSelectedStyle = "color: #88C83D; background:#fff; border: 1px solid #88C83D !important;padding:3px 55px;margin-left:35px;";
                 } 
                  function checkRequiredfields(){
                  lumSumConfirm = document.getElementById("GETemplate:GETemplate:mainForm:lumpSumValue");
                                                    
                    if(lumSumConfirm.value.trim() == "YES"){
                        document.getElementById(debtLumpSumYes1).setAttribute("style",selectedStyle);
                        document.getElementById(debtLumpSumNo1).setAttribute("style",unSelectedStyle);
                    }else if(lumSumConfirm.value.trim() == "NO"){
                        document.getElementById(debtLumpSumNo1).setAttribute("style",selectedStyle);
                        document.getElementById(debtLumpSumYes1).setAttribute("style",unSelectedStyle);
                    }
                    
                   
            }
              
               checkRequiredfields();
    </script>
    <apex:composition template="{!$Site.Template}">    

 <apex:define name="GEDDBody">
 <apex:stylesheet value="{!URLFOR($Resource.mobileoveride, '/css/mobile-overide.css')}" />
 <apex:stylesheet value="{!URLFOR($Resource.JQUERY10, '/jquery-ui-1.10.3.custom/css/redmond/jquery-ui-1.10.3.custom.min.css')}" />

    <!--Added by MDAVID - 02/29/2016 TQLQW - 104 Rebranding-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <!--<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>-->
    <!--Changed by TXU to reference internal static resource-->
    <link href="{!URLFOR($Resource.ge_web_template, '/ge_web_template/bower_components/bootstrap/dist/css/bootstrap.min.css')}" rel="stylesheet" media="screen" id="stylelink" />
    <c:App_WebAnalyticAttributes basecontroller="{!this}"/> <!--Afreen - 26-SEPT-2016 - US-519   -->
     <header>   
         <div id="header" class="header">
            <apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), false, true)}">
             <div class="row-fluid header-inner headerlogovr">                    
                 <div class="mobilell">
                     <div class="loginlogout span3 removelmargin helplogindesk">
                         <apex:form >
                             <apex:pageBlock >
                                 <div class="span12 fleft">
                                     <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                                    <apex:commandButton value="{!$Label.CUI_header_save_application}" onclick="setNavigationFlag('false');headerButtons('register');" styleClass="btn btn-block btn-normalc buttonarrowimg GPrimary-button" reRender="false" rendered="{!NOT(isRegistered) && Not(isBrokerChannel)}"/>
                                    <apex:commandButton value="{!$Label.CUI_header_logout}" onclick="setNavigationFlag('false');headerButtons('logout')" styleClass="btn btn-block btn-normalc buttonarrowimg GPrimary-button" reRender="false" rendered="{!isRegistered}"/>
                                    </div>
                             </apex:pageBlock>
                         </apex:form>
                     </div>
                 </div>
             </div>
             </apex:panelGroup>
            <!-- START - Added by MDAVID - 03/01/2016 TQLQW - 104 Rebranding-->
            <apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), true, false)}">
                <apex:panelGroup rendered="{!NOT(isRegistered) && Not(isBrokerChannel)}">
                    <div class="row-fluid header-inner headerlogovr">                    
                        <div class="mobilell">
                            <div class="loginlogout span3 removelmargin helplogindesk">
                                <apex:form >
                                    <apex:pageBlock >
                                        <div class="span12 fleft">
                                            <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                                            <button type="submit" onclick="setNavigationFlag('false');headerButtons('register');return false;" class="btn btn-block btn-normalc btn-large GPrimary-button greenSave" reRender="false">Save Application<!--<span class="arrowrighticon" style="margin-left:20px"></span>--></button>
                                        </div>
                                    </apex:pageBlock>
                                </apex:form>
                            </div>
                        </div>
                    </div>
                    </apex:panelGroup>
                    <apex:panelGroup rendered="{!(isRegistered)}">
                    <div class="row-fluid header-inner headerlogovr"  style="padding: 0 0 0 0 !important;">                    
                        <div class="mobilell">
                            <div class="loginlogout span3 removelmargin helplogindesk">
                                <apex:form >
                                    <apex:pageBlock >
                                        <div class="span12 fleft">
                                            <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                                            <button type="submit" onclick="setNavigationFlag('false');headerButtons('logout');return false;" class="btn btn-block btn-normalc btn-large GPrimary-button greenSave" reRender="false" style="float:right">Logout<span class="arrowrighticon" style="margin-left:20px"></span></button>
                                        </div>
                                    </apex:pageBlock>
                                </apex:form>
                            </div>
                        </div>
                    </div>
                </apex:panelGroup>
            </apex:panelGroup>
            <!--END - Added by MDAVID - 03/01/2016 TQLQW - 104 Rebranding-->
         </div>
         <div class="divider10"></div>
         
         <!-- created a separate header title for mobile version -->
        <div class="headertitle GHeader-title" style="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), 'display:block', 'display:none')}">
            <h3 class="droid-normal dark main-page-header">Personal loan <span class="clearright"></span>application</h3>
        </div>
     </header>
     <!--end of new header-->    

            <section>
                <!-- Added onSubmit attribute for Better Start Added by Suneel -->
                <apex:form id="loanForm" styleClass="validateLoanForm" onSubmit="return loanAmtBSAU() || hideDebtError()">
                    <!-- Checkmarx -->
                    <!--<apex:inputField id="loanPurposeSize" value="{!loanPurposeSize}"/>-->
                    <apex:inputHidden id="loanPurposeSize" value="{!loanPurposeSize}"/>
                     <!-- Better Start -->
          <apex:actionFunction name="loanTermSelect" action="{!getLoanTermOnProduct}" reRender="loan_selected"/>
        <apex:actionFunction name="productSelection" action="{!getProductOnLoanSelection}" rerender="product_selected"/>

          <!-- End -->
                    <apex:actionFunction name="validateLoan" action="{!validateLoanFields}" rerender="loanForm,loanValid" status="pleasewait" 
                    oncomplete="checkDebtFields('Save'); showOtherLoanPurpose();adjustStyleSheets();"/>
                    
                    <!-- MLASALA 20-SEPT-16 TQLQW-483 Gen 2 App form -->
                    <!-- MLASALA 11-OCT-2016 Commented out and moved to APP_Main component to be resuable for all pages -->
                    <!--<apex:actionFunction name="validateLoanBack" action="{!validateLoanFields}" rerender="loanForm,loanValid" -->
                    <!--status="pleasewait" oncomplete=" checkDebtFields('Back'); showOtherLoanPurpose();"/>-->
                    
                    <apex:actionFunction name="UpdateAmount"  action="{!calculateLoanAmountTotal}" 
                    reRender="Exp_total" oncomplete="showOtherLoanPurpose();"/>
                    <!--Added by MDAVID - 02/29/2016 TQLQW - 104 Rebranding-->

                    <apex:actionFunction name="addDebt" action="{!addDebt}" status="pleasewait" rerender="debtPageBlock1" oncomplete="validateForm(); return false;"/>
                    <apex:actionFunction name="addLoanPurpose" action="{!addLoanPurpose}" rerender="loanForm,loanPurposeSize,OtherPanelId" status="removeStatus" onComplete="showOtherLoanPurpose();"/>
                    <apex:actionFunction name="removeLoanPurpose" action="{!removeLoanPurpose}" rerender="loanForm,loanPurposeSize" rendered="{!if(loanPurposeSize >=2, true, false)}" status="removeStatus" onComplete="showOtherLoanPurpose();"/>
                        
                    <div class="lp_area_mobile"> <!--Added by MDAVID - 03/16/2016 TQLQW - 104 Rebranding - For Mobile-->
                    <div class="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), 'lp_eligibility', 'maincontent lp_area lp_eligibility')}">
                    <div class="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), 'container-fluid headerbackground', 'row-fluid')}">
                        <div class="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), 'lp_area lp_eligibility', 'row-fluid span12 loanfields')}">
                        <div class="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), 'row-fluid', '')}">   
                            <!-- Start of Content Here -->
                            <div class="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), 'row-fluid span12', '')}">
                                <div id="addfields" class="tablemainlist llfields {!if(OR($site.Name=='Latitude', $site.Name=='Gem'), 'width800', '')}">
                                    <div class="headertitle" style="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), 'display:block', 'display:none')}">
                                        <h3 class="droid-normal dark main-page-header">Personal loan <span class="clearright"></span>application</h3>
                                    </div>
                                    
                                    <!-- Start Loop-->
                                    <apex:repeat value="{!loanWrapList}" var="l" id="lw">
                                        <!-- <apex:pageBlockSection id="Loan_Purpose__c-1"> -->
                                            <c:APP_Main country="{!brand.country__c}" l="{!l}" id="component-1"/>
                                        <!-- </apex:pageBlockSection> -->
                                    </apex:repeat>
                                    <div class="clearfix"></div>
                                    <div id="countIcons" class="span12 adjustmeicon">
                                        <!--Commented out by MDAVID - 03/02/2016 TQLQW - 104 Rebranding
                                        <div class="minusplusicon miconad"><!-- container for minus icon
                                            <apex:commandButton value=" " styleClass="minusfield" action="{!removeLoanPurpose}" rerender="loanForm,loanPurposeSize" rendered="{!if(loanPurposeSize >=2, true, false)}" status="removeStatus" onComplete="showOtherLoanPurpose();"/>
                                        </div>
                                        <div class="minusplusicon adconad"><!-- container plus icon
                                            <apex:commandButton value="" styleClass="plusfield" action="{!addLoanPurpose}" rerender="loanForm,loanPurposeSize" rendered="{!loanPurposeSize <=9}" status="addStatus" oncomplete="showOtherLoanPurpose();"/>
                                        </div>-->
                                        <apex:panelGroup rendered="{!if(loanPurposeSize >=2, true, false)}">
                                        <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                                        <div class="minusplusicon miconad GRemove-loan">
                                            <span class="minusicon" onclick="removeLoanPurpose()"></span>
                                        </div>
                                        </apex:panelGroup>
                                        <apex:panelGroup rendered="{!loanPurposeSize <=9}">
                                        <div class="minusplusicon adconad mv_addicon">
                                            <span class="plusicon" onclick="addLoanPurpose()"></span>
                                        </div>
                                        </apex:panelGroup>
                                    </div>
                                    <div class="clearfix"></div>
                                </div><!-- addfields -->
                            </div>

                        <div class="clearfix"></div>
                          <!-- Product dropdown better start-->
                       <div  class="span4" style="width: {!if($site.Name='Latitude','127px; font-size: 16px !important; color: #ffffff !important;','115px')};">
                          <apex:outputLabel rendered="{!IF($CurrentPage.parameters.form == 'broker' && isBSOfferActive, true, false)}" styleClass="gem-subtitle" style="{!if($site.Name=='Latitude','color: #ffffff !important; font-family: Lexia Book !important; font-size: 16px !important;','')} margin-left:695px">Product</apex:outputLabel>
                        </div>
                       <apex:outputPanel rendered="{!IF($CurrentPage.parameters.form == 'broker' && isBSOfferActive, true, false)}" style="width:222px;margin:auto;margin-left:785px" layout="block" id="product_selected">
                          <apex:selectList styleClass="input-block-level isPicklistLoanTerm dropdownicon checkPreviousFields removebmargin" size="1" value="{!productSelected}" onChange="selectLoanTerm()"  id="Product_SubType_Selected">
                            <apex:selectOptions value="{!productOptions}"/>
                          </apex:selectList>
                        <!--  <apex:outputText styleClass="warningMessage" escape="false" rendered="{!loanTermNotValid}" value="You must select a loan term."/> -->
                       </apex:outputPanel> 
                       <!-- End --> 
                       <!--- Better Start -->
                       <apex:outputPanel rendered="{!IF($CurrentPage.parameters.subType== 'betterStart', true, false)}" >
                        <div id="demo" style="background-color:#CC0033 !important;width:500px;margin:auto;color:#ffffff !important;font-family:initital;padding-left:28px">                       </div>
                       </apex:outputPanel>
                       <!--- End --->
                    </div>
                    </div>
                    </div>
                    <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                    <div class="container-fluid loanamountdiv">
                    <div class="maincontent">
                    <div class="row-fluid">
                        <div class="computation {!if(OR($site.Name=='Latitude', $site.Name=='Gem'), 'comp700', '')} overfieldFix2">
                            <div class="span5 dbtotal">
                                <span class="totalname">Total loan amount:</span>
                                <span class="total">
                                    <apex:outputText value="${0, number, ###,###,###,##0.00}" id="Exp_total">
                                        <apex:param value="{!totAmount}"/>
                                    </apex:outputText>
                                    <apex:outputText styleClass="warningMessage" escape="false" rendered="{!loanAmountNotValid}" value="<br/>Error: Your preferred loan amount must be at least ${!validLPAmount}."/><!--UPDATED by RCADAPAN @ 08-MAR-2016 to merge Valid Total Loan Amount per Region - TQLQW-29-->
                                </span>
                                
                            </div>
                            <div class="span6 overfield pull-right removelmargin input100pct">
                                <div class="span4" style="{!if($site.Name=='Latitude','width:127px','width: 120px')}">
                                        <apex:outputLabel styleClass="gem-subtitle">{!$Label.Over}</apex:outputLabel>
                                </div>
                                <div class="span6" style="width: 127px">
                                 <!-- Added the below OutPanel condition by Suneel BetterStart -->
                                        <apex:outputPanel id="loan_selected"  layout="block">
                                        <apex:selectList styleClass="input-block-level isPicklistNone dropdownicon" id="loanterm" size="1" value="{!loanTermSelected}" >
                                            <apex:selectOptions value="{!loanTermOptions}"/>
                                        </apex:selectList>
                                        <apex:outputText styleClass="warningMessage" escape="false" rendered="{!loanTermNotValid}" value="Error: You must select a loan term."/>
                               </apex:outputPanel>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </div><!-- computation -->
                    </div>
                </div><!-- end maincontent -->
                </div><!-- end continer-fluid -->
                </div>
                </div>
<script type="text/javascript">
    function showOtherLoanPurpose(){
        var loanrepeat = document.getElementById("GETemplate:GETemplate:loanForm:loanPurposeSize");
        for(var i=0;i<loanrepeat.value;i++){
            var purpose = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Value__c");
            var other = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:OtherPanelId");

            if(purpose.value == 'Other'){
                other.style.display = "block";
            }else{
                other.style.display = "none";
            }
        }
    }
    showOtherLoanPurpose();
     function selectLoanTerm(){
                             loanTermSelect();
                             }
                             function selectProductLoan(){
        productSelection();
        }
</script>
                </apex:form>

                <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                <apex:outputPanel rendered="{!OR($site.Name=='Latitude', $site.Name=='Gem', $site.Name=='Kiwibank')}">
                    <c:LFS_ProgressIndicator />
                </apex:outputPanel>
                
                <div class="maincontent sidebar-left GMob-container">
                    <div class="row-fluid">                
                        <!-- Start of Content Here -->                    
                        <!-- sidebar -->
                        <apex:outputPanel rendered="{!$site.Name=='Aussie'}">
                            <div class="span4 earlyfull sidebar dashboardarea">
                            <!-- Sidebar -->
                                <apex:form >
                                    <c:GEDDSidebar />
                                </apex:form>
                            </div><!-- span3 sidebar -->
                        </apex:outputPanel>
                    
                        <!-- right column -->
                        <div class="{!if(OR($site.Name=='Latitude', $site.Name=='Gem', $site.Name=='Kiwibank'), 'span12', 'span7')} earlyfull page-income width800">

                            

                            <div class="divider10"></div>
                            
                              <!---  Sprint 4 - help text for time out session ---->
                        <div class="clearfix"></div>
                            <div>                                            
                                    <h5 style="color: #75787b; margin-bottom:5px;margin-left: 5px;">
                                        <apex:outputText rendered="{!Not(isBrokerChannel)}">Note your session will time out after 15 minutes of inactivity, we recommend you save your application</apex:outputText>    
                                        <apex:outputText rendered="{!(isBrokerChannel)}">Note your session will timeout after 15 minutes of inactivity </apex:outputText>                                       
                                    </h5>
                            </div>                                                       
                            <div class="clearfix" ></div>
                            <div class="clearfix" style="height:20px"></div>  

                            <apex:form id="mainForm" styleClass="validateMainForm">

                                <!-- Commenting this section Sprint 4 --->
                                <!--- <div id="warning" title="Session timeout warning." style=" display: none;">
                                <p><span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;">
                                </span>Please save your Application before session times out.</p>
                                </div>--->
                                      
            <!-- Time out changed for Broker and Customer in Sprint 4 --->
                            <div  id="warning" title="Do you want to continue?" style="display: none; font-size:11px !important; overflow:hidden;" >    
                                <p style="font-size:14px !important;line-height:12px;">
                                    <span class="" style="float: left; margin: 0 0px 20px 0;font-size:11px !important;"></span>
                                    <apex:outputText rendered="{!(isBrokerChannel)}">This application will time out in 10 minutes. 
                                        <br/>
                                        <br/>
                                        Please click OK to continue. </apex:outputText>
                                    <apex:outputText rendered="{!Not(isBrokerChannel)}" >
                                        This application will time out in 10 minutes. Please click OK to continue. 
                                        <br/> 
                                        <br/> 
                                        Note: If you wish to resume later please save your application. 
                                    </apex:outputText>
                                </p>
                            </div>  

                                <apex:inputHidden id="flag"/>
                                <apex:inputHidden id="navFlag"/>
                                <!-- Checkmarx -->
                                <!--<apex:inputField id="redirectTxt" value="{!redirectTo}"/>-->
                                <!--<apex:inputField id="destinationPage" value="{!destinationPage}"/>-->
                                <!--<apex:inputField id="callingPage" value="{!callingPage}"/>-->
                                <!--<apex:inputField id="selectedId" value="{!selectedRow}"/>-->
                                <!--<apex:inputField id="blackBox" value="{!blackBox}"/>-->
                                <!--<apex:inputField id="loanValid" value="{!loanValidationResults}"/>-->
                                <apex:inputHidden id="redirectTxt" value="{!redirectTo}"/>
                                <apex:inputHidden id="destinationPage" value="{!destinationPage}"/>
                                <apex:inputHidden id="callingPage" value="{!callingPage}"/>
                                <apex:inputHidden id="selectedId" value="{!selectedRow}"/>
                                <apex:inputHidden id="blackBox" value="{!blackBox}"/>
                                <apex:inputHidden id="debtExempt" value="{!applicant.Debts_Exempt__c}"/>
                                <apex:inputHidden id="loanValid" value="{!loanValidationResults}"/>
                                <!-- Responsible Lending -->
                                <apex:inputHidden id="lumpSumValue" value="{!confirmLumpSum}"/>
                                <!-- MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form -->
                                <apex:inputHidden id="debtValid" value="{!debtValidationResults}"/>
                                <!-- BEGIN MLASALA: 23-SEPT-15 - ASYNC TO SYNC CALL OUT -->
                                <apex:actionFunction name="validateApplication" action="{!validateApply}" 
                                rerender="errorId, blackBox" oncomplete="setNavigationFlag(null);submitServiceCall();"/>
                                <apex:actionFunction name="submitServiceCall" action="{!submitServiceCallCustomer}"/>

                                <!-- END MLASALA: 23-SEPT-15 - ASYNC TO SYNC CALL OUT -->
                                <apex:actionFunction name="navigate" action="{!pageNavigation}" rerender="false"/>
                                <!-- MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form -->
                                <apex:actionFunction name="validateDebt" action="{!pageRedirect}" 
                                rerender="debtPageBlock1,errorId,loanValid,debtValid" status="pleasewait" onComplete="setBlackBox();"/>
                                <apex:actionFunction name="getTotalScript" action="{!getTotalDebt}" rerender="false"/>
                                <apex:actionFunction name="removeAllDebts" action="{!removeAllDebts}" 
                                rerender="debtPageBlock" status="pleasewait"/>
                                <apex:actionFunction name="removeDebt" action="{!removethisDebt}" 
                                rerender="debtPageBlock1" status="pleasewait"/>
                                <apex:actionFunction name="headerRegister" action="{!register}"/>
                                <apex:actionFunction name="headerLogout" action="{!logout}"/>

                                
                                <!-- <apex:pageBlock id="debtPageBlock"> -->
                                    <div class="mobileCon">
                                        <h2 class="gem-heading">Debts</h2>
                                        <div class="divider10"></div>
                                        <div class="{!if(!OR($site.Name=='Latitude', $site.Name=='Gem', $site.Name=='Kiwibank'), 'fright', '')} labelrightdark2 lfsCheckBox input100pct">
                                            <label class="checkbox" for="checkbox" style="margin-top: 0px;">
                                                <input type="checkbox" id="Applicant__c___Debts_Exempt__c" onclick="hideDebts();" 
                                                styleClass="input-block-level"/>
                                                <apex:outputText rendered="{!AND(NOT(applicant.Debts_Exempt__c),applicantList.size>1)}">We</apex:outputText><apex:outputText rendered="{!AND(NOT(applicant.Debts_Exempt__c),applicantList.size==1)}">I</apex:outputText> don&#39;t have any debts
                                            </label>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>
                                <apex:pageBlock id="debtPageBlock">
                                    <div class="mobileCon">
                                    <apex:pageMessages id="errorId"/>
                                    <div class="clearfix"></div>
                                    <apex:outputPanel rendered="{!AND(NOT(applicant.Debts_Exempt__c),applicantList.size>1)}">
                                        <div class="span12">
                                            <p id="subtitleId" class="labeldark lfsText" style="margin-top: 30px;">We have these debts</p>
                                        </div>
                                    </apex:outputPanel>
                                    <div class="clearfix"></div>
                                        <div class="fieldbottom"></div>
                                        <!-- <div class="divider10"></div> -->
                                    <apex:pageBlock id="debtPageBlock1" rendered="{!NOT(applicant.Debts_Exempt__c)}">
                                        
                                        <apex:repeat value="{!debtAddList}" id="debtWrapList" var="debtWrap">
                                            <c:APP_JointDebtAndLiabilities debtWrap="{!debtWrap}" 
                                            listSize="{!debtAddList.size}" 
                                            brandRegion="{!brand.country__c}"
                                            id="component-1"/>
                                        </apex:repeat>
                                        
                                        <div class="divider10"></div>
                                        <!-- add more here button -->
                                        <apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), false, true)}">
                                            <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                                            <apex:commandButton styleClass="btn btn-large btn-block btn-addc btn-addanother GAdd-income" 
                                            value="Add another debt" action="{!addDebt}" rerender="debtPageBlock1" style="{!if($site.Name=='Kiwibank','padding-right: 0 !important;','')}"
                                            rendered="{!if(debtListSize <=9, true, false)}"
                                            status="pleasewait"/>
                                        </apex:panelGroup>
                                        <!-- Added by MDAVID - 02/29/2016 TQLQW - 104 Rebranding-->
                                        <apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), true, false)}">
                                            <!--REPLACED HTML BUTTON WITH APEX BUTTON by RUSSELL CADAPAN @ 22/04/2016 -->
                                            <!--
                                            <button type="button" class="btn btn-large btn-block GAdd-income"
                                            onclick="addDebt();"  rendered="{!if(debtListSize <=9, true, false)}" >Add another debt
                                            <span class="addanothericon" style="margin-left:20px"></span></button>
                                            -->
                                            <apex:commandButton styleClass="btn btn-large btn-addanother btn-block GAdd-income" 
                                            value="Add another debt" action="{!addDebt}" rerender="debtPageBlock1" 
                                            rendered="{!if(debtListSize <=9, true, false)}" 
                                            oncomplete="return false;"   status="pleasewait"/>
                                        </apex:panelGroup>
                                        <div class="divider10"></div>
                                        <div class="clearfix"></div>
                                        <br/>
                                        
                                        
                                    </apex:pageBlock>
                                    <apex:pageBlock id="lumpSumBlock">
                                     <apex:outputPanel rendered="{!if(OR($site.Name = 'Kiwibank', $site.Name = 'Gem'), true, false)}">
                                        
                                       <div class="privacyloancontent kiwilumpsum gem-mobile" style="float:left;width: 589px;" id="lumpSumPay">
                                       <hr/>
                                        <label class="kiwilumpsum labeldark" style="width: 80%;">Do any of your loans require a <a href="#" title="Lump sum payment" data-toggle="popover" data-trigger="focus" data-content="A lump sum or balloon payment is one large payment that's due at the end of a loan following smaller monthly payments. Some loans come with balloon payments to lower the regular monthly repayments without extending the loan term. Some car loans include multiple lump sum payments where 1/3 is paid at the beginning of the loan, 1/3 is paid in the middle of the loan, and 1/3 is paid at the end of the loan." onclick="return false;">lump sum payment</a> either during or at the end of the loan?</label>                                        
                                          <apex:outputLabel value="YES" styleClass="gem-mobile-button slds-button slds-button--neutral" id="lumpSumYes1" onclick="applicantConfirmation(this);hideDebtError();" style="{!if(AND($site.Name == 'Gem',confirmLumSumpFlag=='YES'),'color: #fff; background:#4465ad; border: 1px solid #4465ad !important;padding:3px 55px;margin-left:35px;',if(AND($site.Name == 'Kiwibank',confirmLumSumpFlag=='YES'),'color: #fff; background:#88C83D; border: 1px solid #88C83D !important;padding:3px 55px;margin-left:35px;','color: #969696; background:#ffffff; border: 1px solid #969696 !important;padding:3px 55px;margin-left:35px;'))}"/>
                                          <apex:outputLabel value="NO" styleClass=" gem-mobile-button slds-button slds-button--neutral" id="lumpSumNo1" onclick="applicantConfirmation(this);hideDebtError();" style="{!if(AND($site.Name == 'Gem',confirmLumSumpFlag=='NO'),'color: #fff; background:#4465ad; border: 1px solid #4465ad !important;padding:3px 55px;margin-left:35px;',if(AND($site.Name == 'Kiwibank',confirmLumSumpFlag=='NO'),'color: #fff; background:#88C83D; border: 1px solid #88C83D !important;padding:3px 55px;margin-left:35px;','color: #969696; background:#ffffff; border: 1px solid #969696 !important;padding:3px 55px;margin-left:35px;'))}"/>
                                          <apex:inputText style="visibility:hidden;height:0;width:0" id="confirmLumSumpFlag" styleClass="" value="{!confirmLumSumpFlag}"/>
                                          <div id="debtErr" style="display:none;"/>
                                        <hr/>
                                        </div>
                                       
                                        </apex:outputPanel>
                                       </apex:pageBlock>
                                    
                                    <div class="divider10"></div>
                                    <div class="clearfix"></div>

                                     <!-- Loading -->
<apex:actionStatus id="pleasewait" layout="block">
    <apex:facet name="start">
        <apex:image url="{!URLFOR($Resource.getheme, 'images/loading-bar.gif')}" styleClass="fright"/>
    </apex:facet> 
</apex:actionStatus>
<div class="divider10"></div>

<!--<div class="row-fluid marginlftzero">
   <div class="span12">
       <apex:commandButton value="Back" 
                                        action="{!backPage}" onclick="setNavigationFlag('false'); lockoutSubmit(this); if(validateForm()){UpdateAmount(); validateLoan(); return false;}" status="saveStatus" styleClass="btn btn-block btn-large btn-reset-m btn-normalc fleft buttonarrowimgleft GPrimary-button" 
                                        rerender="false" style="width: 150px !important;"/>
    <apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), false, true)}">
        <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
        <!-- BEGIN MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form -->
        <!-- UPDATED NEXT TO SUBMIT -->
        <!--<apex:commandButton value="Submit" 
         onclick="setNavigationFlag('false'); lockoutSubmit(this); if(validateForm()){UpdateAmount(); validateLoan(); return false;}" 
         status="saveStatus" styleClass="btn btn-block btn-large btn-reset-m btn-normalc fright buttonarrowimg GPrimary-button" rerender="false" />
    </apex:panelGroup>
    <!-- Added by MDAVID - 02/29/2016 TQLQW - 104 Rebranding-->
    <!--<apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), true, false)}">
        <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
       <!--<button type="submit"-->
       <!--onclick="setNavigationFlag('false'); lockoutSubmit(this); if(validateForm()){UpdateAmount(); validateLoan(); return false;}" -->
       <!--status="saveStatus" class="btn btn-block btn-large btn-reset-m btn-normalc fright GPrimary-button" rerender="false">Next-->
       <!--<span class="arrowrighticon" style="margin: 0 0 0 20px"></span></button>-->
       
        <!-- UPDATED NEXT TO SUBMIT -->
        <!--<apex:commandButton style="width:150px !important" value="Submit" 
        onclick="setNavigationFlag('false'); lockoutSubmit(this); if(validateForm()){UpdateAmount(); validateLoan(); return false;}" 
        status="saveStatus" styleClass="btn btn-block btn-large btn-reset-m btn-normalc fright buttonarrowimg GPrimary-button" rerender="false" />
        <!-- END MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form -->
        
    <!--</apex:panelGroup>   
    </div>
</div>

<div class="divider10"></div>-->
                                </div>
                                <!-- Added by Matthew Gould 16/09/2016 Rebranding -->
                                <div class="row-fluid marginlftzero">
                                   <div class="span12">
                                       <!-- MLASALA 11-OCT-2016 Updated previous button properties for all pages -->
                                       <!--onclick="setNavigationFlag('false'); lockoutSubmit(this); if(validateForm()){UpdateAmount(); validateLoanBack(); return false;}"-->
                                       <apex:commandButton value="Previous" onclick="checkFields('.validateMainForm');"
                                            status="saveStatus" styleClass="btn btn-block btn-large btn-reset-m btn-normalc fleft buttonarrowimgleft GPrimary-button lfs-prev-btn" 
                                            rerender="false"/>
                                       <apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), false, true)}">
                                       <apex:panelGroup >
                                           <!-- reBrand by gerome.teodosio@cloudsherpas.com -->
                                           <!--change the button as part of the softquote -->
                                           <apex:commandButton onclick="setNavigationFlag('false'); lockoutSubmit(this);  if(validateForm()){UpdateAmount(); validateLoan();};" 
                                           value="{!if(AND($site.Name=='Kiwibank',isSoftQuoteApp), 'Submit', 'Get Quote')}" status="saveStatus" 
                                           styleClass="btn btn-block btn-large btn-reset-m btn-normalc fright GPrimary-button buttonarrowimg lfs-next-btn" 
                                           rerender="false" > <span class="arrowrighticon" style="margin-left:20px"></span></apex:commandButton>
                                        </apex:panelGroup>
                                       </apex:panelGroup>
                                       <!-- Added by MDAVID - 02/29/2016 TQLQW - 104 Rebranding-->
                                       <apex:panelGroup rendered="{!if(OR($site.Name = 'Latitude', $site.Name = 'Gem'), true, false)}">
                                           <!--<button type="submit" onclick="setNavigationFlag('false'); lockoutSubmit(this);  if(validateForm()){UpdateAmount(); validateLoan(); return false};" -->
                                           <!--status="saveStatus" -->
                                           <!--class="btn btn-block btn-large btn-reset-m btn-normalc fright" -->
                                           <!-->Next-->
                                           <!--<span class="arrowrighticon" style="margin-left:20px"></span></button>-->
                                           
                                           <!-- UPDATED NEXT TO SUBMIT -->
                                            <!-- Soft quote changes -->
                                            <apex:commandButton value="{!if(OR($site.Name=='Latitude', AND($site.Name=='Gem',isSoftQuoteApp)), 'Submit', 'Get Quote')}"
                                                                style="{!if(!OR($site.Name=='Latitude', $site.Name=='Gem', $site.Name=='Kiwibank'), 'width: 150px !important;', 'padding-inline-start: 15px;')}"
                                            onclick="setNavigationFlag('false'); lockoutSubmit(this); if(validateForm()){UpdateAmount(); validateLoan(); return false;}" 
                                            status="saveStatus" styleClass="btn btn-block btn-large btn-reset-m btn-normalc fright buttonarrowimg GPrimary-button lfs-next-btn" rerender="false" />
                                            <!-- END MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form -->
                                       </apex:panelGroup>
                                   </div>
                                </div>
                              <div class="divider10"></div>
                                    
                                </apex:pageBlock>
                            </apex:form>

                        </div><!-- span7 earlyfull -->
                        
                        <!-- End of Content -->
                    </div>
                </div><!-- end maincontent -->
            </section>
            
            <!-- BEGIN MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form -->
            <!-- iOVATION INCLUDE SCRIPT FOR FINGERPRINT -->
            <apex:includeScript value="https://mpsnare.iesnare.com/snare.js" />
            
            <script language="JavaScript">
                function setBlackBox(){     //method for populating blackbox and other variables needed
                    var isLoanValid = document.getElementById('GETemplate:GETemplate:mainForm:loanValid');
                    var isDebtValid = document.getElementById('GETemplate:GETemplate:mainForm:debtValid');
                    console.log('isLoanValid: '+isLoanValid.value+', isDebtValid: '+isDebtValid.value);
                    if(isLoanValid.value == 'true' && 
                      isDebtValid.value == 'true'){
                        // basic configuration
                        var io_install_stm = false;     // do not install Active X
                        var io_exclude_stm = 12;        // do not run Active X
                        var io_install_flash = false;   // do not install Flash
                        var io_enable_rip = true;       // enable detection of Real IP
                        var bb_data = ioGetBlackbox();  // get blackbox data
                
                        document.getElementById('GETemplate:GETemplate:mainForm:blackBox').value = bb_data.blackbox;    //seT blackbox data to inputhidden
                        validateApplication();      //actionfunction method on related pages
                    }
                }
            </script>
            <!-- END MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form -->
             <!-- Hotjar Tracking Code for www.latitudefinancial.com.au -->
        <script>
            (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:826763,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
            })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
        </script>
            <script>
                // Created by: Adrian Recio
                // Description: Function to disable/enable button onprocess events
                function lockoutSubmit(button) {
                    var oldValue = button.value;
                
                    button.setAttribute('disabled', true);
                    //MLASALA 12-SEPT-16 TQLQW-483 - Gen 2 App form
                    //Updated to submit
                    //button.value = 'Submit';
                
                    setTimeout(function(){
                        button.value = oldValue;
                        button.removeAttribute('disabled');
                    }, 5000)
                }
                
                function deleteRow(Id){
                    document.getElementById('GETemplate:GETemplate:mainForm:selectedId').value = Id;
                    removeDebt();                  
                }

                var j$ = jQuery.noConflict();
                function hideDebts(){
                    var debtExempt = document.getElementById('Applicant__c___Debts_Exempt__c');

                    document.getElementById('GETemplate:GETemplate:mainForm:debtExempt').value = debtExempt.checked;

                    if(debtExempt.checked == true){
                        j$("#GETemplate\\:GETemplate\\:mainForm\\:debtPageBlock\\:debtPageBlock1").hide();
                        j$("#subtitleId").hide();
                    } else {
                        j$("#GETemplate\\:GETemplate\\:mainForm\\:debtPageBlock\\:debtPageBlock1").show();
                        j$("#subtitleId").show();
                    }
                    removeAllDebts();
                    
                }

                function pageRedirect(pageref){
                    var callingtile = pageref.value;
                    document.getElementById("GETemplate:GETemplate:mainForm:destinationPage").value = callingtile;
                    document.getElementById("GETemplate:GETemplate:mainForm:callingPage").value = 'Debts / Liabilities';
                    document.getElementById('GETemplate:GETemplate:mainForm:flag').value = false;
                    navigate();
                }
                function trimField(element){
                    element.value = element.value.replace(/,/g,"");
                }
                
                function setFlag(){
                    document.getElementById('GETemplate:GETemplate:mainForm:flag').value = null;
                }
                
                function checkDebtFields(action){
                  
                    document.getElementById('GETemplate:GETemplate:mainForm:redirectTxt').value = action;
                    document.getElementById('GETemplate:GETemplate:mainForm:flag').value = false;
                    validateDebt();
                }
                            
                var j$ = jQuery.noConflict();
                var timeout = "{!TimeOut}";
                var warning = "{!Warning}";
                var timeoutGap = timeout - warning;
                var originalTimeOut = timeout;

                j$(document).ready(function () {
                    //Zero the idle timer on mouse movement or keypress.
                    j$('#warning').dialog(undefined);
                    j$('#warning').dialog().dialog('close');
                    
                    j$(this).mousemove(function (e) {
                        timeout = originalTimeOut;
                        // j$('#warning').dialog('close');
                    });
                    j$(this).keypress(function (e) {
                        timeout = originalTimeOut;
                        //   j$('#warning').dialog('close');
                    });              
                });
                var noted = false;
                var notedTime = 2;
                
                function countDown(){
                    if(timeout <= 0){
                        setNavigationFlag("false");
                        checkDebtFields('Timeout');
                    } else {
                        timeout--;
                        if(timeout == timeoutGap){
                            //alert('Please save your Application before session times out');
                            j$(function() {
                                j$( "#warning" ).dialog({
                                  resizable: false,
                                  height:180,
                                  modal: true,
                                  buttons: {
                                    "OK": function() {
                                      j$( this ).dialog( "close" );
                                    }
                                  }
                                });
                            });
                        }
                        setTimeout("countDown()", 1000);
                    }
                }
                
                function isCharacterKey(evt, field) {
                    var charCode = (evt.which) ? evt.which : event.keyCode;
                    if ((charcode==08 || charCode <= 32 || charCode == 8 || charCode == 46 || 
                    ((charCode >= 65 && charCode <= 90) || (charCode >= 97 && charCode <= 122)) || charCode ==  45 || charCode ==  39)){
                        return true;
                    }
                    return false;
                }
                
                function isNumberKeyWithCharLimit(evt, field) {
                    var charCode = (evt.which) ? evt.which : event.keyCode;
                    if (charCode > 31 && (charCode < 48 || charCode > 57)) return false;
                    return true;
                }
                
                function isCharacterKeyHyphenOnly(evt, field) {
                    var charCode = (evt.which) ? evt.which : event.keyCode;
                    if ((charCode==08 || charCode <= 32 || charCode == 8 || charCode == 46 || 
                    ((charCode >= 65 && charCode <= 90) || (charCode >= 97 && charCode <= 122)) || charCode ==  45)){
                        return true;
                    }
                    return false;
                }
                
                function isNumberKey(evt, field) {
                    var charCode = (evt.which) ? evt.which : event.keyCode;
                    if (charCode != 46 && charCode > 31
                      && (charCode < 48 || charCode > 57))
                        return false;
                    if(charCode == 8) return true;
                    if(charCode == 46) return false;
                    return true;
                }
                
                function isAlNumericWithHyphen(evt, field) {
                    var charCode = (evt.which) ? evt.which : event.keyCode;
                    if ((charCode == 08 || charCode == 45 || charCode == 8 || charCode == 189 || charCode == 39 || charCode == 32 ||
                    ((charCode >= 65 && charCode <= 90) || (charCode >= 97 && charCode <= 122) || (charCode >= 48 && charCode <= 57))))
                        return true;
                     
                    return false;
                }
                
                function isAlNumericWithHyphenOnly(evt, field) {
                    var charCode = (evt.which) ? evt.which : event.keyCode;
                    if ((charCode == 08 || charCode == 45 || charCode == 8 || charCode == 189 || charCode == 32 ||
                    ((charCode >= 65 && charCode <= 90) || (charCode >= 97 && charCode <= 122) || (charCode >= 48 && charCode <= 57))))
                        return true;
                     
                    return false;
                }
                function debtExempt(){
                    var debtExempt = document.getElementById('GETemplate:GETemplate:mainForm:debtExempt').value
                    if(debtExempt == 'true'){
                        document.getElementById('Applicant__c___Debts_Exempt__c').checked = debtExempt;
                    }
                }
                
                function executeLoad(){
                    debtExempt();
                    countDown();
                    checkRequiredfields();
                    
                    //MLASALA 11-OCT-2016 Populate onload array
                    onLoadValues = populateOnLoadvalues('.validateMainForm');
                }

                /*  Description: Function used for the header buttons "Save Application" & "Logout"
                 *  Author: Jade Serrano
                 *  Date Created: 09-APR-2014
                 *  Input: None
                 *  Return:
                 */
                function headerButtons(action){
                    if(action == 'register'){
                        //action function
                        headerRegister();
                    }else if(action == 'logout'){
                        //action function
                        headerLogout();
                    }
                }
                executeLoad();
                window.onbeforeunload = function(e){
                    var flag = document.getElementById("GETemplate:GETemplate:mainForm:navFlag");
                    if(flag.value == false){
                        //return "Application has not been saved. Do you wish to exit?";
                    }
                }
                function setNavigationFlag(val){
                    document.getElementById('GETemplate:GETemplate:mainForm:navFlag').value = val;
                }

                function adjustStyleSheets(){
                var res = document.getElementById("GETemplate:GETemplate:mainForm:loanValid");
                    if(res.value == "false"){
                        document.getElementById("countIcons").className = "span12 adjustmeicon triggericon";
                    }
                }
            </script>
            
            <!-- @title     Design OverRide for APP_JointDebtandLiabilities VF Page -->
            <!-- @author    gerome.teodosio@cloudsherpas.com                        -->
            <!--            gerome.h.teodosio@Accenture.com                         -->
            
            <!-- Include StylePicker component to fix general brand style issues -->
            <c:APP_GSD_StylePicker />
            
            <!-- Aussie brand styling specific for APP_JointDebtandLiabilities VF Page -->
            <apex:outputPanel rendered="{!$Site.Name=='Aussie'}">
                <link href="{!URLFOR($Resource.LatitudeIcons, '/LatitudeIcons/aussie-iconfix.css')}" rel="stylesheet" />
                <style>
                    .btn.btn-large.btn-block.btn-addc.btn-addanother.GAdd-income:hover {
                        background-color: #512d6d !important;
                        border: 2px solid transparent !important;
                        color: white !important;
                    }
                    
                    .btn.btn-large.btn-block.btn-addc.btn-addanother.GAdd-income:focus {
                        background-color: #5D8A25 !important;
                    }
            
                    @media screen and (max-width: 415px) {
                        .btn.btn-block.btn-normalc.buttonarrowimg.GPrimary-button {
                            margin-top: -75px;
                        }
                        
                        .span5.headertitle {
                            margin-left: 0 !important;
                        }
                    }
                    
                    @media screen and (min-width: 415px) {
                        .maincontent .maincontent {
                            margin-left: -15px !important;
                        }
                        
                        .span8 h2 {
                            margin: 0;
                            margin-bottom: 20px !important;
                        }
                        
                        .boxlink {
                            margin: 2px !important;
                        }
                        
                        .adconad {
                            padding: 0 !important;
                            width: 25px;
                            height:25px;
                            margin-top: -35px;
                        }
                        
                        span.minusicon {
                            width: 25px;
                            height: 25px;
                            display: inherit;
                        }
                        
                        .minusplusicon .plusicon {
                            height: 25px;
                            width: 25px;
                            display: block;
                        }
                        
                        .tablemainlist > span > .span12 {
                            margin-left: 20px !important;
                            text-align: right;
                        }
                        
                        div#countIcons {
                            width: 930px;
                            margin-left: 50px;
                        }
                    }
                /*For Iphone 4 and 5*/
                @media screen and (max-width: 320px) and (orientation: portrait) {
                    .span5.headertitle {
                        width: 70% !important;
                    }
                }
                /*For Iphone 6*/
                @media screen and (min-width: 321px) and (max-width: 375px) and (orientation: portrait) {
                    .span5.headertitle {
                        width: 75% !important;
                    }
                }
                /*For Iphone 6+*/
                @media screen and (min-width: 376px) and (max-width: 425px) and (orientation: portrait) {
                    .span5.headertitle {
                        width: 75% !important;
                    }
                }
                </style>
            </apex:outputPanel>
            
            <!-- Gem brand styling specific for APP_JointDebtandLiabilities VF Page -->
            <apex:outputPanel rendered="{!$Site.Name=='Gem'}">
                <link href="{!URLFOR($Resource.LatitudeIcons, '/LatitudeIcons/gem-icons.css')}" rel="stylesheet" />
                <style>
                    span.addanothericon {
                        background-size: 20px;
                    }
                  
                    button.btn.btn-large.btn-block.removelmargin {
                        height: 40px;   
                    }
                    
                    .page-income > h2 {
                        margin-top: 0;
                    }
                    
                    .btn.btn-block.btn-large.btn-reset-m.btn-normalc.fright.GPrimary-button {
                        background-image:none;
                        padding-right: 30px !important;
                    }
                    span.fui-arrow-left {
                        margin-top: 0px;
                        margin-left: 10px;
                    }
                    @media screen and (min-width: 415px) {
                        .nav-tabs > li.active > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
                            background: #4465ad !important;
                            color: white !important;
                        }
                        
                        button.btn.btn-large.btn-block.removelmargin {
                            width: 100% !important;
                        }
                        
                        .sidebar-left {
                            padding-top: 40px !important;
                        }
                        
                        #countIcons {
                            width: 760px;
                            margin-left: -20px;
                        }
                        
                        .btn.btn-large.btn-block.GAdd-income {
                            width: 100% !important;
                            background-color: transparent !important;
                            color: black;
                            border: 2px dashed #e1e1e1;
                        }
                        
                        .btn.btn-large.btn-block.GAdd-income:hover {
                            background-color: #88cdd3 !important;
                        }
                    }
                    .minusplusicon.adconad.GAdd-02,
                    .minusplusicon.miconad.GMinus-02{
                       display: none;
                    }
                    @media screen and (min-width: 375px) {
                        .btn.btn-large.btn-block.GAdd-income {
                            width: 100% !important;
                            background-color: transparent !important;
                            color: #000 !important;
                            border: 2px dashed #e1e1e1 !important;
                            background-position: 70%;
                        }      
                        .btn.btn-large.btn-block.GAdd-income:active {
                            background-color: #88cdd3 !important;
                            border: 2px solid #88cdd3 !important;
                        }
                    }
                    /*For Iphone 4 and 5*/
                    @media screen and (max-width: 320px) and (orientation: portrait) {
                        .headertitle {
                            margin-left: 50px;
                        } 
                        .btn.btn-large.btn-block.GAdd-income {
                            width: 100% !important;
                            background-color: transparent !important;
                            color: #000 !important;
                            border: 2px dashed #e1e1e1 !important;
                            background-position: 70%;
                        }      
                        .btn.btn-large.btn-block.GAdd-income:active {
                            background-color: #88cdd3 !important;
                            border: 2px solid #88cdd3 !important;
                        }
                        .textleft {
                            margin-top: 13px;
                            width: 250px;
                        }
                    }
                    
                    /*For Iphone 6*/
                    @media screen and (min-width: 321px) and (max-width: 375px) and (orientation: portrait) {
                        .headertitle {
                            margin-left: 70px;
                        }
                        .textleft {
                            margin-top: 13px;
                        }
                    }
                    
                    /*For Iphone 6+*/
                    @media screen and (min-width: 376px) and (max-width: 425px) and (orientation: portrait) {
                        .headertitle {
                            margin-left: 80px;
                        }
                        .textleft {
                            margin-top: 13px;
                        }
                    }
                </style>     
            </apex:outputPanel>
            
            <!-- Latitude brand styling specific for APP_JointDebtandLiabilities VF Page -->
            <apex:outputPanel rendered="{!$Site.Name=='Latitude'}">
                <link href="{!URLFOR($Resource.LatitudeIcons, '/LatitudeIcons/lat-iconfix.css')}" rel="stylesheet" />

                <style>
                    span.addanothericon {
                        background-size: 20px;
                    }
                    
                    .page-income > h2 {
                        margin-top: 0;
                    }
                    
                    @media screen and (max-width: 415px) {
                        .lp_eligibility {
                            display: none !important;
                        }   
                    }
                  
                    @media screen and (min-width: 415px) {
                        button.btn.btn-large.btn-block.removelmargin {
                            width: 100% !important;
                        }   
                        
                        div#countIcons {
                            width: 800px;
                            margin-left: -80px;
                            display:block !important;
                        }
                        
                        .minusplusicon.adconad.GAdd-02,
                        .minusplusicon.miconad.GMinus-02{
                            display: none;
                        }
                    }

                    /*For Iphone 4 and 5*/
                    @media screen and (max-width: 320px) and (orientation: portrait) {
                        .headertitle {
                            margin-left: 70px;
                        }
                        .textleft {
                            margin-top: 13px;
                            width: 250px;
                        }
                    }
                    /*For Iphone 6 and 6+*/
                    @media screen and (min-width: 321px) and (max-width: 414px) and (orientation: portrait) {
                        .minusplusicon {
                            width: 40px;
                        }
                        .headertitle {
                            margin-left: 85px;
                        }
                        .textleft {
                            margin-top: 13px;
                        }
                    }
                    /*For Iphone 6+*/
                    @media screen and (min-width: 376px) and (max-width: 425px) and (orientation: portrait) {
                        .headertitle {
                            margin-left: 95px;
                        }
                    }
                </style>     
           </apex:outputPanel>
           
           <script>
           
           $(document).ready(function(){
          $('[data-toggle="popover"]').popover({html:true});   
      });
      
     //Better Start
         if("{!$CurrentPage.parameters.subType}" == "betterStart"){
                                        enableLoanPurpose();
                                        loanAmtBSAU();
                                        }
                        function enableLoanPurpose(){
                            var loansize = document.getElementById("GETemplate:GETemplate:loanForm:loanPurposeSize");
                            for(var i=0;i<1;i++){
                              var firstLP = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Value__c").disabled=true;
    
                            }
                            for(var i=1;i<15;i++){
                            //var option = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Value__c");
                           // option.value = 'Please Select';
                            var lpSize = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Value__c").disabled=false;
                           
                            }                        
                        }
                        
                        
                        function loanAmtBSAU(){
                            if("{!$CurrentPage.parameters.subType}" == "betterStart"){
                            if('{!brand.country__c}' == 'AU'){ 
                            var loansize = document.getElementById("GETemplate:GETemplate:loanForm:loanPurposeSize");
                                    for(var i=0;i<1;i++){
                                        var firstLP = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Loan_Amount__c");
                                        var lpValue = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Value__c");
                                        if(firstLP.value < 20000 || lpValue.value != 'Debt consolidation' ){
                                        document.getElementById("demo").style.display = "block";
                                        //document.getElementById("demo").innerHTML = "Better Start loans have a minimum loan amount of $20,000. If this amount meets your needs, please update the loan amount. Alternatively, please select one of our other loan types which you can view at: <a style= 'color:antiquewhite;text-decoration:underline;padding:0px;' href=https://www.latitudefinancial.com.au/loans/>https://www.latitudefinancial.com.au/loans/</a>";                
                                         document.getElementById("demo").innerHTML = "A Better Start Personal Loan must be for Debt Consolidation for $20,000 or more";
                                         return false;
                                        } else if(firstLP.value >= 20000 && lpValue.value == 'Debt consolidation'){
                                        document.getElementById("demo").style.display = "none";
                                        }                       
                                    }   
                                 }                                 
                                else{
                                    var loansizeNZ = document.getElementById("GETemplate:GETemplate:loanForm:loanPurposeSize");
                                    for(var i=0;i<1;i++){
                                        var firstLPNZ = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Loan_Amount__c");
                                        var lpValueNZ = document.getElementById("GETemplate:GETemplate:loanForm:lw:"+i+":component-1:Loan_Purpose__c-mycomponent:Loan_Purpose__c____Value__c");
                                        if(firstLPNZ.value < 20000 || lpValueNZ.value != 'Consolidation' ){
                                        document.getElementById("demo").style.display = "block";
                                        document.getElementById("demo").innerHTML = "Better Start loans have a minimum loan amount of $20,000. If this amount meets your needs, please update the loan amount. Alternatively, please select one of our other loan types which you can view at: <a style= 'color:antiquewhite;text-decoration:underline;padding:0px;' href=https://www.latitudefinancial.com.au/loans/>https://www.latitudefinancial.com.au/loans/</a>";                
                                        return false;
                                        } else if(firstLPNZ.value >= 20000 && lpValueNZ.value == 'Consolidation'){
                                        document.getElementById("demo").style.display = "none";
                                        }                       
                                    }          
                                }
                                                      
                            } 
                       }            
                        //End
    </script>
            
            <!-- Kiwibank brand styling specific for APP_JointDebtandLiabilities VF Page -->
            <apex:outputPanel rendered="{!$Site.Name=='Kiwibank'}">
                <link href="{!URLFOR($Resource.LatitudeIcons, '/LatitudeIcons/kiwibank-iconfix.css')}" rel="stylesheet" />
                <style>
                    .nav-tabs > li.active > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
                        background: #88C83D !important;
                        color: white !important;
                    }
                    
                    .apexp .pbBody .btn-block.buttonarrowimg,
                    .apexp .pbBody .btn-block.buttonarrowimg:hover,
                    .btn.btn-block.btn-normalc.buttonarrowimg.GPrimary-button,
                    .btn.btn-block.btn-normalc.buttonarrowimg.GPrimary-button:hover {
                        text-align: left !important;
                        color: white !important;
                    }
        
                    @media screen and (min-width: 415px) {
                        .maincontent.sidebar-left.mobileCon.GMob-container {
                            margin-top: 20px;
                        }
            
                        .btn.btn-large.btn-block.btn-addc.btn-addanother.GAdd-income {
                            background-color: #fff !important;
                            border: 2px dashed #e1e1e1;
                            color: #555555;
                            text-align: center !important;
                       }
                       
                       .btn.btn-large.btn-block.btn-addc.btn-addanother.GAdd-income:hover {
                           background-color: #88C83D !important;
                           color: white;
                           border: 2px solid #88C83D;
                       }
                       
                       .boxlink {
                           margin: 2px !important;
                       }
                       
                       .btn.btn-block.btn-normalc.buttonarrowimg.GPrimary-button {
                            background-color: #88c83d !important;
                        }
                        
                        .pllabel {
                            width: 90px;
                            text-align: right;
                        }
                        
                        .pllabel label {
                            font-weight: normal;
                        }
                            
                        .inpselfield select,
                        select {
                            height: 40px !important;
                            margin-top: 5px;
                        }
                            
                        .page-income h2 {
                            margin-top: 0;
                        }
                        
                        #countIcons .plusicon {
                            height: 25px;
                            width: 25px;
                            display: block;
                        }
                        
                        .btn.btn-block.btn-normalc.buttonarrowimg.GPrimary-button {
                            margin-top: 0;
                            text-align:left !important;
                        }
                    }
                    
                    @media screen and (max-width: 415px) {
                        .btn.btn-block.btn-normalc.buttonarrowimg.GPrimary-button {
                            margin-top: -80px !important;
                        }
                        
                        .btn.btn-block.btn-large.btn-reset-m.btn-normalc.fright.buttonarrowimg.GPrimary-button {
                            margin: 0 !important;
                        }
                        
                        .nav-tabs > li.active > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
                            background: #88C83D !important;
                            color: white !important;
                        }
                    }
                </style>
            </apex:outputPanel>
            
        </apex:define>
    </apex:composition>
</apex:page>